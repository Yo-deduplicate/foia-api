id: foia_agency_report
label: 'Create a node from an annual report in NIEM-XML format.'
migration_group: foia_xml
migration_tags:
  - Content
source:
  plugin: url
  data_fetcher_plugin: file
  urls:
    - 'temporary://foia-xml/report.xml'
  data_parser_plugin: simple_xml
  namespaces:
    iepd: 'http://leisp.usdoj.gov/niem/FoiaAnnualReport/exchange/1.03'
    foia: 'http://leisp.usdoj.gov/niem/FoiaAnnualReport/extension/1.03'
    i: 'http://niem.gov/niem/appinfo/2.0'
    j: 'http://niem.gov/niem/domains/jxdm/4.1'
    nc: 'http://niem.gov/niem/niem-core/2.0'
    s: 'http://niem.gov/niem/structures/2.0'
    xsi: 'http://www.w3.org/2001/XMLSchema-instance'
  item_selector: '/iepd:FoiaAnnualReport'
  # Does shared_configuration get included with a deep merge? If not, then we
  # will have to repeat these fields in every migration.
  fields:
    -
      name: report_year
      label: 'Fiscal year for the current report'
      selector: '/iepd:FoiaAnnualReport/foia:DocumentFiscalYearDate'
    -
      name: agency
      label: 'Standard abbreviation of the agency submitting the report'
      selector: '/iepd:FoiaAnnualReport/nc:Organization/nc:OrganizationAbbreviationText'
  # Section V.A
  # @todo Find something more reliable than using @s:id="PS0" for the overall
  # numbers.
    -
      name: component_va
      label: 'Internal index of the agency component'
      selector: 'foia:ProcessedRequestSection/foia:ProcessingStatistics/@s:id'
    -
      name: overall_req_pend_start_yr
      label: 'Overall requests pending at the start of the year'
      selector: 'foia:ProcessedRequestSection/foia:ProcessingStatistics[@s:id="PS0"]/foia:ProcessingStatisticsPendingAtStartQuantity'
    -
      name: overall_req_received_yr
      label: 'Overall requests received during the year'
      selector: 'foia:ProcessedRequestSection/foia:ProcessingStatistics[@s:id="PS0"]/foia:ProcessingStatisticsReceivedQuantity'
    -
      name: overall_req_processed_yr
      label: 'Overall requests processed during the year'
      selector: 'foia:ProcessedRequestSection/foia:ProcessingStatistics[@s:id="PS0"]/foia:ProcessingStatisticsProcessedQuantity'
    -
      name: overall_req_pend_end_yr
      label: 'Overall requests pending at the end of the year'
      selector: 'foia:ProcessedRequestSection/foia:ProcessingStatistics[@s:id="PS0"]/foia:ProcessingStatisticsPendingAtEndQuantity'
    -
      name: footnotes_va
      label: 'V.A Footnotes'
      selector: 'foia:ProcessedRequestSection/foia:FootnoteText'
  # Section VI.A
  # @todo Find something more reliable than using @s:id="PA0" for the overall
  # numbers.
    -
      name: component_via
      label: 'Internal index of the agency component'
      selector: 'foia:ProcessedAppealSection/foia:ProcessingStatistics/@s:id'
    -
      name: overall_app_pend_start_yr
      label: 'Overall appeals pending at the start of the year'
      selector: 'foia:ProcessedAppealSection/foia:ProcessingStatistics[@s:id="PA0"]/foia:ProcessingStatisticsPendingAtStartQuantity'
    -
      name: overall_app_received_yr
      label: 'Overall appeals received during the year'
      selector: 'foia:ProcessedAppealSection/foia:ProcessingStatistics[@s:id="PA0"]/foia:ProcessingStatisticsReceivedQuantity'
    -
      name: overall_app_processed_yr
      label: 'Overall appeals processed during the year'
      selector: 'foia:ProcessedAppealSection/foia:ProcessingStatistics[@s:id="PA0"]/foia:ProcessingStatisticsProcessedQuantity'
    -
      name: overall_app_pend_end_yr
      label: 'Overall appeals pending at the end of the year'
      selector: 'foia:ProcessedAppealSection/foia:ProcessingStatistics[@s:id="PA0"]/foia:ProcessingStatisticsPendingAtEndQuantity'
    -
      name: footnotes_via
      label: 'V.A Footnotes'
      selector: 'foia:ProcessedAppealSection/foia:FootnoteText'
  # Section VI.B
  # @todo Find something more reliable than using @s:id="AD0" for the overall
  # numbers.
    -
      name: component_vib
      label: 'Internal index of the agency component'
      selector: 'foia:AppealDispositionSection/foia:AppealDisposition/@s:id'
    -
      name: field_overall_vib_affirm_on_app
      label: 'Agency Overall Number Affirmed on Appeal'
      selector: 'foia:AppealDispositionSection/foia:AppealDisposition[@s:id="AD0"]/foia:AppealDispositionAffirmedQuantity'
    -
      name: field_overall_vib_part_on_app
      label: 'Agency Overall Number Partially Affirmed & Partially Reversed/Remanded on Appeal'
      selector: 'foia:AppealDispositionSection/foia:AppealDisposition[@s:id="AD0"]/foia:AppealDispositionPartialQuantity'
    -
      name: field_overall_vib_comp_on_app
      label: 'Agency Overall Number Completely Reversed/Remanded on Appeal'
      selector: 'foia:AppealDispositionSection/foia:AppealDisposition[@s:id="AD0"]/foia:AppealDispositionReversedQuantity'
    -
      name: field_overall_vib_closed_oth_app
      label: 'Agency Overall Number of Appeals Closed for Other Reasons'
      selector: 'foia:AppealDispositionSection/foia:AppealDisposition[@s:id="AD0"]/foia:AppealDispositionOtherQuantity'
    -
      name: field_overall_vib_total
      label: 'Agency Overall Total'
      selector: 'foia:AppealDispositionSection/foia:AppealDisposition[@s:id="AD0"]/foia:AppealDispositionTotalQuantity'
  # Section VI.C.4
  # @todo Find something more reliable than using @s:id="ART0" for the overall
  # numbers.
    -
      name: component_vic4
      label: 'Internal index of the agency component'
      selector: 'foia:AppealResponseTimeSection/foia:ResponseTime/@s:id'
    -
      name: field_overall_vic4_med_num_days
      label: 'Overall median number of days response time for admin appeals'
      selector: 'foia:AppealResponseTimeSection/foia:ResponseTime[@s:id="ART0"]/foia:ResponseTimeMedianDaysValue'
    -
      name: field_overall_vic4_avg_num_days
      label: 'Overall average number of days response time for admin appeals'
      selector: 'foia:AppealResponseTimeSection/foia:ResponseTime[@s:id="ART0"]/foia:ResponseTimeAverageDaysValue'
    -
      name: field_overall_vic4_low_num_days
      label: 'Overall lowest number of days response time for admin appeals'
      selector: 'foia:AppealResponseTimeSection/foia:ResponseTime[@s:id="ART0"]/foia:ResponseTimeLowestDaysValue'
    -
      name: field_overall_vic4_high_num_days
      label: 'Overall highest number of days response time for admin appeals'
      selector: 'foia:AppealResponseTimeSection/foia:ResponseTime[@s:id="ART0"]/foia:ResponseTimeHighestDaysValue'
    -
      name: field_footnotes_vic4
      label: 'Response Time for Administrative Appeals Footnote'
      selector: 'foia:AppealResponseTimeSection/foia:FootnoteText'
  # Section VII.A
  # @todo Find something more reliable than using @s:id="PRT0" for the overall
  # numbers.
    -
      name: component_viia
      label: 'Internal index of the agency component'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime/@s:id'
    -
      name: field_overall_viia_sim_med
      label: 'Overall Processed Requests - Simple - Median Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:SimpleResponseTime/foia:ResponseTimeMedianDaysValue'
    -
      name: field_overall_viia_sim_avg
      label: 'Overall Processed Requests - Simple - Average Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:SimpleResponseTime/foia:ResponseTimeAverageDaysValue'
    -
      name: field_overall_viia_sim_low
      label: 'Overall Processed Requests - Simple - Lowest Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:SimpleResponseTime/foia:ResponseTimeLowestDaysValue'
    -
      name: field_overall_viia_sim_high
      label: 'Overall Processed Requests - Simple - Highest Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:SimpleResponseTime/foia:ResponseTimeHighestDaysValue'
    -
      name: field_overall_viia_comp_med
      label: 'Overall Processed Requests - Complex - Median Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:ComplexResponseTime/foia:ResponseTimeMedianDaysValue'
    -
      name: field_overall_viia_comp_avg
      label: 'Overall Processed Requests - Complex - Average Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:ComplexResponseTime/foia:ResponseTimeAverageDaysValue'
    -
      name: field_overall_viia_comp_low
      label: 'Overall Processed Requests - Complex - Lowest Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:ComplexResponseTime/foia:ResponseTimeLowestDaysValue'
    -
      name: field_overall_viia_comp_high
      label: 'Overall Processed Requests - Complex - Highest Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:ComplexResponseTime/foia:ResponseTimeHighestDaysValue'
    -
      name: field_overall_viia_exp_med
      label: 'Overall Processed Requests - Expedited - Median Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:ExpeditedResponseTime/foia:ResponseTimeMedianDaysValue'
    -
      name: field_overall_viia_exp_avg
      label: 'Overall Processed Requests - Expedited - Average Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:ExpeditedResponseTime/foia:ResponseTimeAverageDaysValue'
    -
      name: field_overall_viia_exp_low
      label: 'Overall Processed Requests - Expedited - Lowest Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:ExpeditedResponseTime/foia:ResponseTimeLowestDaysValue'
    -
      name: field_overall_viia_exp_high
      label: 'Overall Processed Requests - Expedited - Highest Response Time'
      selector: 'foia:ProcessedResponseTimeSection/foia:ProcessedResponseTime[@s:id="PRT0"]/foia:ExpeditedResponseTime/foia:ResponseTimeHighestDaysValue'
    -
      name: field_footnotes_viia
      label: 'VII.A Footnotes'
      selector: 'foia:ProcessedResponseTimeSection/foia:FootnoteText'
  # Section VII.B
  # @todo Find something more reliable than using @s:id="IGR0" for the overall
  # numbers.
    -
      name: component_viib
      label: 'Internal index of the agency component'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime/@s:id'
    -
      name: field_overall_viib_sim_med
      label: 'Information Granted Requests - Simple - Median Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:SimpleResponseTime/foia:ResponseTimeMedianDaysValue'
    -
      name: field_overall_viib_sim_avg
      label: 'Information Granted Requests - Simple - Average Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:SimpleResponseTime/foia:ResponseTimeAverageDaysValue'
    -
      name: field_overall_viib_sim_low
      label: 'Information Granted Requests - Simple - Lowest Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:SimpleResponseTime/foia:ResponseTimeLowestDaysValue'
    -
      name: field_overall_viib_sim_high
      label: 'Information Granted Requests - Simple - Highest Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:SimpleResponseTime/foia:ResponseTimeHighestDaysValue'
    -
      name: field_overall_viib_comp_med
      label: 'Information Granted Requests - Complex - Median Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:ComplexResponseTime/foia:ResponseTimeMedianDaysValue'
    -
      name: field_overall_viib_comp_avg
      label: 'Information Granted Requests - Complex - Average Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:ComplexResponseTime/foia:ResponseTimeAverageDaysValue'
    -
      name: field_overall_viib_comp_low
      label: 'Information Granted Requests - Complext - Lowest Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:ComplexResponseTime/foia:ResponseTimeLowestDaysValue'
    -
      name: field_overall_viib_comp_high
      label: 'Information Granted Requests - Complex - Highest Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:ComplexResponseTime/foia:ResponseTimeHighestDaysValue'
    -
      name: field_overall_viib_exp_med
      label: 'Information Granted Requests - Expedited - Median Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:ExpeditedResponseTime/foia:ResponseTimeMedianDaysValue'
    -
      name: field_overall_viib_exp_avg
      label: 'Information Granted Requests - Expedited - Average Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:ExpeditedResponseTime/foia:ResponseTimeAverageDaysValue'
    -
      name: field_overall_viib_exp_low
      label: 'Information Granted Requests - Expedited - Lowest Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:ExpeditedResponseTime/foia:ResponseTimeLowestDaysValue'
    -
      name: field_overall_viib_exp_high
      label: 'Information Granted Requests - Expedited - Highest Response Time'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:ProcessedResponseTime[@s:id="IGR0"]/foia:ExpeditedResponseTime/foia:ResponseTimeHighestDaysValue'
    -
      name: field_footnotes_viib
      label: 'VII.B Footnotes'
      selector: 'foia:InformationGrantedResponseTimeSection/foia:FootnoteText'
  # Section VII.D
  # @todo Find something more reliable than using @s:id="PPR0" for the overall
  # numbers.
    -
      name: component_viid
      label: 'Internal index of the agency component'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests/@s:id'
    -
      name: field_overall_viid_sim_med
      label: 'Pending Requests - Simple Number of Days - Median'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests[@s:id="PPR0"]/foia:SimplePendingRequestStatistics/foia:PendingRequestMedianDaysValue'
    -
      name: field_overall_viid_sim_avg
      label: 'Pending Requests - Simple Number of Days - Average'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests[@s:id="PPR0"]/foia:SimplePendingRequestStatistics/foia:PendingRequestAverageDaysValue'
    -
      name: field_overall_viid_sim_pend
      label: 'Pending Requests - Simple Number of Days - Pending'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests[@s:id="PPR0"]/foia:SimplePendingRequestStatistics/foia:PendingRequestQuantity'
    -
      name: field_overall_viid_comp_med
      label: 'Pending Requests - Complex Number of Days - Median'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests[@s:id="PPR0"]/foia:ComplexPendingRequestStatistics/foia:PendingRequestMedianDaysValue'
    -
      name: field_overall_viid_comp_avg
      label: 'Pending Requests - Complex Number of Days - Average'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests[@s:id="PPR0"]/foia:ComplexPendingRequestStatistics/foia:PendingRequestAverageDaysValue'
    -
      name: field_overall_viid_comp_pend
      label: 'Pending Requests - Complex Number of Days - Pending'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests[@s:id="PPR0"]/foia:ComplexPendingRequestStatistics/foia:PendingRequestQuantity'
    -
      name: field_overall_viid_exp_med
      label: 'Pending Requests - Expedited Number of Days - Median'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests[@s:id="PPR0"]/foia:ExpeditedPendingRequestStatistics/foia:PendingRequestMedianDaysValue'
    -
      name: field_overall_viid_exp_avg
      label: 'Pending Requests - Expedited Number of Days - Average'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests[@s:id="PPR0"]/foia:ExpeditedPendingRequestStatistics/foia:PendingRequestAverageDaysValue'
    -
      name: field_overall_viid_exp_pend
      label: 'Pending Requests - Expedited Number of Days - Pending'
      selector: 'foia:PendingPerfectedRequestsSection/foia:PendingPerfectedRequests[@s:id="PPR0"]/foia:ExpeditedPendingRequestStatistics/foia:PendingRequestQuantity'
    -
      name: field_footnotes_viid
      label: 'VII.D Footnotes'
      selector: 'foia:PendingPerfectedRequestsSection/foia:FootnoteText'
  # Section VIII.A
  # @todo Find something more reliable than using @s:id="EP0" for the overall
  # numbers.
    -
      name: component_viiia
      label: 'Internal index of the agency component'
      selector: 'foia:ExpeditedProcessingSection/foia:ExpeditedProcessing/@s:id'
    -
      name: field_overall_viiia_num_grant
      label: 'Placeholder Label - VIIIA - field_overall_viiia_num_grant'
      selector: 'foia:ExpeditedProcessingSection/foia:ExpeditedProcessing[@s:id="EP0"]/foia:RequestGrantedQuantity'
    -
      name: field_overall_viiia_num_denied
      label: 'Placeholder Label - VIIIA - field_overall_viiia_num_deniedage'
      selector: 'foia:ExpeditedProcessingSection/foia:ExpeditedProcessing[@s:id="EP0"]/foia:RequestDeniedQuantity'
    -
      name: field_overall_viiia_med_days_jud
      label: 'Pending Requests - Simple Number of Days - Pending'
      selector: 'foia:ExpeditedProcessingSection/foia:ExpeditedProcessing[@s:id="EP0"]/foia:AdjudicationMedianDaysValue'
    -
      name: field_overall_viiia_avg_days_jud
      label: 'Placeholder Label - VIIIA - field_overall_viiia_avg_days_jud'
      selector: 'foia:ExpeditedProcessingSection/foia:ExpeditedProcessing[@s:id="EP0"]/foia:AdjudicationAverageDaysValue'
    -
      name: field_overall_viiia_num_jud_w10
      label: 'Placeholder Label - VIIIA - field_overall_viiia_num_jud_w10'
      selector: 'foia:ExpeditedProcessingSection/foia:ExpeditedProcessing[@s:id="EP0"]/foia:AdjudicationWithinTenDaysQuantity'
    -
      name: field_footnotes_viiia
      label: 'VIII.A Footnotes'
      selector: 'foia:ExpeditedProcessingSection/foia:FootnoteText'
  # Section VIII.B
  # @todo Find something more reliable than using @s:id="FW0" for the overall
  # numbers.
    -
      name: component_viiib
      label: 'Internal index of the agency component'
      selector: 'foia:FeeWaiverSection/foia:FeeWaiver/@s:id'
    -
      name: field_overall_viiib_num_grant
      label: 'Placeholder Label - VIIIB - field_overall_viiib_num_grant'
      selector: 'foia:FeeWaiverSection/foia:FeeWaiver[@s:id="FW0"]/foia:RequestGrantedQuantity'
    -
      name: field_overall_viiib_num_denied
      label: 'Placeholder Label - VIIIB - field_overall_viiib_num_deniedage'
      selector: 'foia:FeeWaiverSection/foia:FeeWaiver[@s:id="FW0"]/foia:RequestDeniedQuantity'
    -
      name: field_overall_viiib_med_days_jud
      label: 'Pending Requests - Simple Number of Days - field_overall_viiib_med_days_jud'
      selector: 'foia:FeeWaiverSection/foia:FeeWaiver[@s:id="FW0"]/foia:AdjudicationMedianDaysValue'
    -
      name: field_overall_viiib_avg_days_jud
      label: 'Placeholder Label - VIIIB - field_overall_viiib_avg_days_jud'
      selector: 'foia:FeeWaiverSection/foia:FeeWaiver[@s:id="FW0"]/foia:AdjudicationAverageDaysValue'
    -
      name: field_footnotes_viiib
      label: 'VIII.B Footnotes'
      selector: 'foia:FeeWaiverSection/foia:FootnoteText'
  # Section IX
  # @todo Find something more reliable than using @s:id="PC0" for the overall
  # numbers.
    -
      name: component_ix
      label: 'Internal index of the agency component'
      selector: 'foia:PersonnelAndCostSection/foia:PersonnelAndCost/@s:id'
    -
      name: field_overall_ix_full_emp
      label: 'Placeholder Label - IX - field_overall_ix_full_emp'
      selector: 'foia:PersonnelAndCostSection/foia:PersonnelAndCost[@s:id="PC0"]/foia:FullTimeEmployeeQuantity'
    -
      name: field_overall_ix_eq_full_emp
      label: 'Placeholder Label - IX - field_overall_ix_eq_full_emp'
      selector: 'foia:PersonnelAndCostSection/foia:PersonnelAndCost[@s:id="PC0"]/foia:EquivalentFullTimeEmployeeQuantity'
    -
      name: field_overall_ix_total_staff
      label: 'Pending Requests - Simple Number of Days - field_overall_ix_total_staff'
      selector: 'foia:PersonnelAndCostSection/foia:PersonnelAndCost[@s:id="PC0"]/foia:TotalFullTimeStaffQuantity'
    -
      name: field_overall_ix_proc_costs
      label: 'Placeholder Label - IX - field_overall_ix_proc_costs'
      selector: 'foia:PersonnelAndCostSection/foia:PersonnelAndCost[@s:id="PC0"]/foia:ProcessingCostAmount'
    -
      name: field_overall_ix_lit_costs
      label: 'Placeholder Label - IX - field_overall_ix_lit_costs'
      selector: 'foia:PersonnelAndCostSection/foia:PersonnelAndCost[@s:id="PC0"]/foia:LitigationCostAmount'
    -
      name: field_overall_ix_total_costs
      label: 'Placeholder Label - IX - field_overall_ix_total_costs'
      selector: 'foia:PersonnelAndCostSection/foia:PersonnelAndCost[@s:id="PC0"]/foia:TotalCostAmount'
    -
      name: field_footnotes_ix
      label: 'IX Footnotes'
      selector: 'foia:PersonnelAndCostSection/foia:FootnoteText'
  # Section X
  # @todo Find something more reliable than using @s:id="FC0" for the overall
  # numbers.
    -
      name: component_x
      label: 'Internal index of the agency component'
      selector: 'foia:FeesCollectedSection/foia:FeesCollected/@s:id'
    -
      name: field_overall_x_total_fees
      label: 'Placeholder Label - X - field_overall_x_total_fees'
      selector: 'foia:FeesCollectedSection/foia:FeesCollected[@s:id="FC0"]/foia:FeesCollectedAmount'
    -
      name: field_overall_x_perc_costs
      label: 'Placeholder Label - X - field_overall_x_perc_costs'
      selector: 'foia:FeesCollectedSection/foia:FeesCollected[@s:id="FC0"]/foia:FeesCollectedCostPercent'
    -
      name: field_footnotes_x
      label: 'X Footnotes'
      selector: 'foia:FeesCollectedSection/foia:FootnoteText'
  # Section XI.A
  # @todo Find something more reliable than using @s:id="SU0" for the overall
  # numbers.
    -
      name: component_xia
      label: 'Internal index of the agency component'
      selector: 'foia:SubsectionUsedSection/foia:SubsectionUsed/@s:id'
    -
      name: field_overall_xia_sub_used
      label: 'Placeholder Label - XI.A - field_overall_xia_sub_used'
      selector: 'foia:SubsectionUsedSection/foia:SubsectionUsed[@s:id="SU0"]/foia:TimesUsedQuantity'
    -
      name: field_footnotes_xia
      label: 'XI.A Footnotes'
      selector: 'foia:SubsectionUsedSection/foia:FootnoteText'
  # Section XI.B
  # @todo Find something more reliable than using @s:id="SP0" for the overall
  # numbers.
    -
      name: component_xib
      label: 'Internal index of the agency component'
      selector: 'foia:SubsectionPostSection/foia:Subsection/@s:id'
    -
      name: field_overall_xib_rec_post_foia
      label: 'Placeholder Label - XI.B - field_overall_xib_rec_post_foia'
      selector: 'foia:SubsectionPostSection/foia:Subsection[@s:id="SP0"]/foia:PostedbyFOIAQuantity'
    -
      name: field_overall_xib_rec_post_prog
      label: 'Placeholder Label - XI.B - field_overall_xib_rec_post_prog'
      selector: 'foia:SubsectionPostSection/foia:Subsection[@s:id="SP0"]/foia:PostedbyProgramQuantity'
    -
      name: field_footnotes_xib
      label: 'XI.B Footnotes'
      selector: 'foia:SubsectionPostSection/foia:FootnoteText'
  # Section XII.A
  # @todo Find something more reliable than using @s:id="BK0" for the overall
  # numbers.
    -
      name: component_xiia
      label: 'Internal index of the agency component'
      selector: 'foia:BacklogSection/foia:Backlog/@s:id'
    -
      name: field_overall_xiia_back_req_end_
      label: 'Placeholder Label - XII.A - field_overall_xiia_back_req_end_'
      selector: 'foia:BacklogSection/foia:Backlog[@s:id="BK0"]/foia:PostedbyFOIAQuantity'
    -
      name: field_overall_xiia_back_app_end_
      label: 'Placeholder Label - XII.A - field_overall_xiia_back_app_end_'
      selector: 'foia:BacklogSection/foia:Backlog[@s:id="BK0"]/foia:PostedbyProgramQuantity'
    -
      name: field_footnotes_xiia
      label: 'XII.A Footnotes'
      selector: 'foia:BacklogSection/foia:FootnoteText'
  # Section XII.E.2
  # @todo Find something more reliable than using @s:id="ABC0" for the overall
  # numbers.
    -
      name: component_xiie2
      label: 'Internal index of the agency component'
      selector: 'foia:BackloggedAppealComparisonSection/foia:BacklogComparison/@s:id'
    -
      name: overall_xiie2_back_prev_yr
      label: 'Overall requests pending at the start of the year'
      selector: 'foia:BackloggedAppealComparisonSection/foia:BacklogComparison[@s:id="ABC0"]/foia:BacklogLastYearQuantity'
    -
      name: overall_xiie2_back_cur_yr
      label: 'Overall requests received during the year'
      selector: 'foia:BackloggedAppealComparisonSection/foia:BacklogComparison[@s:id="ABC0"]/foia:BacklogCurrentYearQuantity'
    -
      name: footnotes_xiie2
      label: 'XII.E 2 Footnotes'
      selector: 'foia:BackloggedAppealComparisonSection/foia:FootnoteText'
  ids:
    report_year:
      type: integer
    agency:
      type: string
  constants:
    base_title: 'Annual FOIA Report for'
process:
  type:
    plugin: default_value
    default_value: annual_foia_report_data
  field_foia_annual_report_yr: report_year
  field_agency:
    plugin: entity_lookup
    source: agency
    value_key: field_agency_abbreviation
  langcode:
    plugin: default_value
    default_value: en
  title:
    plugin: concat
    delimiter: ' '
    source:
      - report_year
      - constants/base_title
      - agency
  uid:
    plugin: default_value
    default_value: 1
  status:
    plugin: default_value
    default_value: false
  # @todo Handle workflow status.
  promote:
    plugin: default_value
    default_value: false
  sticky:
    plugin: default_value
    default_value: false
  revision_uid:
    plugin: default_value
    default_value: 1
  revision_log:
    plugin: default_value
    default_value: 'Import from NIEM-XML data'
  # Section V.A
  # FOIA requests -- received, processed and pending FOIA requests
  field_foia_requests_va:
    -
      plugin: foia_array_pad
      source: component_va
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_va_requests
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_req_pend_start_yr: overall_req_pend_start_yr
  field_overall_req_received_yr: overall_req_received_yr
  field_overall_req_processed_yr: overall_req_processed_yr
  field_overall_req_pend_end_yr: overall_req_pend_end_yr
  field_footnotes_va: footnotes_va
  # Section VI.A
  # ADMINISTRATIVE APPEALS OF INITIAL DETERMINATIONS OF FOIA REQUESTS -- RECEIVED, PROCESSED, AND PENDING ADMINISTRATIVE APPEALS
  field_admin_app_via:
    -
      plugin: foia_array_pad
      source: component_via
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_via_disposition
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_via_app_pend_start: overall_app_pend_start_yr
  field_overall_via_app_recd_yr: overall_app_received_yr
  field_overall_via_app_proc_yr: overall_app_processed_yr
  field_overall_via_app_pend_endyr: overall_app_pend_end_yr
  field_footnotes_va: footnotes_via
  # Section VI.B
  # ADMINISTRATIVE APPEALS OF INITIAL DETERMINATIONS OF FOIA REQUESTS -- RECEIVED, PROCESSED, AND PENDING ADMINISTRATIVE APPEALS
  field_admin_app_vib:
    -
      plugin: foia_array_pad
      source: component_vib
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_vib_disposition
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_vib_affirm_on_app: field_overall_vib_affirm_on_app
  field_overall_vib_part_on_app: field_overall_vib_part_on_app
  field_overall_vib_comp_on_app: field_overall_vib_comp_on_app
  field_overall_vib_closed_oth_app: field_overall_vib_closed_oth_app
  field_overall_vib_total: field_overall_vib_total
  # Section VI.C.4
  # ADMINISTRATIVE APPEALS / C. (4) Response Time for Administrative Appeals
  field_admin_app_vic4:
    -
      plugin: foia_array_pad
      source: component_vic4
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_vic4_response_time
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_vic4_avg_num_days: field_overall_vic4_avg_num_days
  field_overall_vic4_high_num_days: field_overall_vic4_high_num_days
  field_overall_vic4_low_num_days: field_overall_vic4_low_num_days
  field_overall_vic4_med_num_days: field_overall_vic4_med_num_days
  field_footnotes_vic4: field_footnotes_vic4
  # Section VII.A
  # Processed Requests - Response Time for All Processed Perfected Requests and for Perfected Requests in Which Information Was Granted.
  field_proc_req_viia:
    -
      plugin: foia_array_pad
      source: component_viia
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_viia_processed_requests
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_viia_sim_med: field_overall_viia_sim_med
  field_overall_viia_sim_avg: field_overall_viia_sim_avg
  field_overall_viia_sim_low: field_overall_viia_sim_low
  field_overall_viia_sim_high: field_overall_viia_sim_high
  field_overall_viia_comp_med: field_overall_viia_comp_med
  field_overall_viia_comp_avg: field_overall_viia_comp_avg
  field_overall_viia_comp_low: field_overall_viia_comp_low
  field_overall_viia_comp_high: field_overall_viia_comp_high
  field_overall_viia_exp_med: field_overall_viia_exp_med
  field_overall_viia_exp_avg: field_overall_viia_exp_avg
  field_overall_viia_exp_low: field_overall_viia_exp_low
  field_overall_viia_exp_high: field_overall_viia_exp_high
  field_footnotes_viia: field_footnotes_viia
  # Section VII.B
  # Processed Requests - Response Time for All Processed Perfected Requests and for Perfected Requests in Which Information Was Granted.
  field_proc_req_viib:
    -
      plugin: foia_array_pad
      source: component_viib
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_viib_processed_requests
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_viib_sim_med: field_overall_viib_sim_med
  field_overall_viib_sim_avg: field_overall_viib_sim_avg
  field_overall_viib_sim_low: field_overall_viib_sim_low
  field_overall_viib_sim_high: field_overall_viib_sim_high
  field_overall_viib_comp_med: field_overall_viib_comp_med
  field_overall_viib_comp_avg: field_overall_viib_comp_avg
  field_overall_viib_comp_low: field_overall_viib_comp_low
  field_overall_viib_comp_high: field_overall_viib_comp_high
  field_overall_viib_exp_med: field_overall_viib_exp_med
  field_overall_viib_exp_avg: field_overall_viib_exp_avg
  field_overall_viib_exp_low: field_overall_viib_exp_low
  field_overall_viib_exp_high: field_overall_viib_exp_high
  field_footnotes_viib: field_footnotes_viib
  # Section VII.D
  # Pending Requests - All Pending Perfected Requests.
  field_pending_requests_vii_d_:
    -
      plugin: foia_array_pad
      source: component_viid
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_viid_pending_requests
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_viid_sim_med: field_overall_viid_sim_med
  field_overall_viid_sim_avg: field_overall_viid_sim_avg
  field_overall_viid_sim_pend: field_overall_viid_sim_pend
  field_overall_viid_comp_med: field_overall_viid_comp_med
  field_overall_viid_comp_avg: field_overall_viid_comp_avg
  field_overall_viid_comp_pend: field_overall_viid_comp_pend
  field_overall_viid_exp_med: field_overall_viid_exp_med
  field_overall_viid_exp_avg: field_overall_viid_exp_avg
  field_overall_viid_exp_pend: field_overall_viid_exp_pend
  field_footnotes_viid: field_footnotes_viid
  # Section VIII.A
  # Placeholder section description.
  field_req_viiia:
    -
      plugin: foia_array_pad
      source: component_viiia
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_viiia_expedited_processing
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_viiia_num_grant: field_overall_viiia_num_grant
  field_overall_viiia_num_denied: field_overall_viiia_num_denied
  field_overall_viiia_num_denied: field_overall_viiia_num_denied
  field_overall_viiia_avg_days_jud: field_overall_viiia_avg_days_jud
  field_overall_viiia_num_jud_w10: field_overall_viiia_num_jud_w10
  field_footnotes_viiia: field_footnotes_viiia
  # Section VIII.B
  # Placeholder section description.
  field_req_viiib:
    -
      plugin: foia_array_pad
      source: component_viiib
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_viiib_fee_waiver
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_viiib_num_grant: field_overall_viiib_num_grant
  field_overall_viiib_num_denied: field_overall_viiib_num_denied
  field_overall_viiib_num_denied: field_overall_viiib_num_denied
  field_overall_viiib_avg_days_jud: field_overall_viiib_avg_days_jud
  field_footnotes_viiib: field_footnotes_viiib
  # Section IX
  # Placeholder section description.
  field_foia_pers_costs_ix:
    -
      plugin: foia_array_pad
      source: component_ix
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_ix_personnel
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_ix_full_emp: field_overall_ix_full_emp
  field_overall_ix_eq_full_emp: field_overall_ix_eq_full_emp
  field_overall_ix_total_staff: field_overall_ix_total_staff
  field_overall_ix_proc_costs: field_overall_ix_proc_costs
  field_overall_ix_lit_costs: field_overall_ix_lit_costs
  field_overall_ix_total_costs: field_overall_ix_total_costs
  field_footnotes_ix: field_footnotes_ix
  # Section X
  # Placeholder section description.
  field_fees_x:
    -
      plugin: foia_array_pad
      source: component_x
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_x_fees
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_x_total_fees: field_overall_x_total_fees
  field_overall_x_perc_costs: field_overall_x_perc_costs
  field_footnotes_x: field_footnotes_x
  # Section XI.A
  # Placeholder section description.
  field_sub_xia:
    -
      plugin: foia_array_pad
      source: component_xia
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_xia_subsection_c
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_xia_sub_used: field_overall_xia_sub_used
  field_footnotes_xia: field_footnotes_xia
  # Section XI.B
  # Placeholder section description.
  field_sub_xib:
    -
      plugin: foia_array_pad
      source: component_xib
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_xib_subsection_a2
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_xib_rec_post_foia: field_overall_xib_rec_post_foia
  field_overall_xib_rec_post_prog: field_overall_xib_rec_post_prog
  field_footnotes_xib: field_footnotes_xib
  # Section XII.A
  # Placeholder section description.
  field_foia_xiia:
    -
      plugin: foia_array_pad
      source: component_xiia
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_xiia
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_xiia_back_req_end_: field_overall_xiia_back_req_end_
  field_overall_xiia_back_app_end_: field_overall_xiia_back_app_end_
  field_footnotes_xiia: field_footnotes_xiia
  # Section XII.E.2
  # FOIA requests -- received, processed and pending FOIA requests
  field_foia_xiie2:
    -
      plugin: foia_array_pad
      source: component_xiie2
      prefix:
        - report_year
        - agency
    -
      plugin: sub_process
      process:
        combined:
          plugin: migration_lookup
          source:
            - '0'
            - '1'
            - '2'
          migration:
            - foia_xiie2
          no_stub: true
        target_id:
          plugin: extract
          source: '@combined'
          index:
            - '0'
        target_revision_id:
          plugin: extract
          source: '@combined'
          index:
            - '1'
  field_overall_xiie2_back_prev_yr: overall_xiie2_back_prev_yr
  field_overall_xiie2_back_cur_yr: overall_xiie2_back_cur_yr
  field_footnotes_xiie2: footnotes_xiie2
destination:
  plugin: entity:node
migration_dependencies:
  required:
    - foia_va_requests
    - foia_via_disposition
    - foia_vib_disposition
    - foia_vic4_response_time
    - foia_viia_processed_requests
    - foia_viib_processed_requests
    - foia_viid_pending_requests
    - foia_viiia_expedited_processing
    - foia_viiib_fee_waiver
    - foia_ix_personnel
    - foia_x_fees
    - foia_xia_subsection_c
    - foia_xib_subsection_a2
    - foia_xiia
    - foia_xiie2
